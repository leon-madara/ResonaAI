# Security Policies Configuration
# Mental Health Platform for East Africa

security:
  # Encryption Settings
  encryption:
    algorithm: "AES-256"
    key_rotation_interval: 90  # days
    master_key_file: "/app/keys/master.key"
    backup_location: "/app/keys/backup/"
    
  # Authentication Settings
  authentication:
    jwt:
      algorithm: "HS256"
      expiration_hours: 24
      secret_key_env: "JWT_SECRET_KEY"
    mfa:
      required_for_admins: true
      required_for_counselors: true
      required_for_users: false
    password_policy:
      min_length: 8
      require_uppercase: true
      require_lowercase: true
      require_numbers: true
      require_special_chars: true
      max_age_days: 90
    
  # Access Control
  access_control:
    rbac:
      enabled: true
      roles:
        - name: "admin"
          permissions: ["*"]
        - name: "counselor"
          permissions: ["read_conversations", "write_responses", "crisis_intervention"]
        - name: "user"
          permissions: ["read_own_data", "write_own_data", "delete_own_data"]
        - name: "system"
          permissions: ["read_system_metrics", "write_logs"]
    ip_whitelist:
      enabled: false
      allowed_ips: []
    rate_limiting:
      enabled: true
      requests_per_minute: 100
      burst_limit: 200
    
  # Data Protection
  data_protection:
    pii_detection:
      enabled: true
      patterns:
        - type: "email"
          regex: "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}"
        - type: "phone"
          regex: "\\+?[1-9]\\d{1,14}"
        - type: "ssn"
          regex: "\\d{3}-\\d{2}-\\d{4}"
    anonymization:
      enabled: true
      methods:
        - "tokenization"
        - "hashing"
        - "masking"
    retention:
      voice_recordings: 30  # days
      transcriptions: 365   # days
      emotion_data: 730     # days
      user_profiles: "until_deletion"
      crisis_records: 2555  # days (7 years)
    
  # Network Security
  network:
    tls:
      version: "1.3"
      cipher_suites:
        - "TLS_AES_256_GCM_SHA384"
        - "TLS_CHACHA20_POLY1305_SHA256"
        - "TLS_AES_128_GCM_SHA256"
    cors:
      enabled: true
      allowed_origins:
        - "https://mentalhealth.ke"
        - "https://www.mentalhealth.ke"
        - "http://localhost:3000"  # Development
      allowed_methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
      allowed_headers: ["*"]
      allow_credentials: true
    firewall:
      enabled: true
      rules:
        - action: "allow"
          protocol: "tcp"
          port: 80
          source: "0.0.0.0/0"
        - action: "allow"
          protocol: "tcp"
          port: 443
          source: "0.0.0.0/0"
        - action: "deny"
          protocol: "tcp"
          port: 22
          source: "0.0.0.0/0"
    
  # Monitoring and Logging
  monitoring:
    log_level: "INFO"
    log_retention_days: 90
    audit_logging:
      enabled: true
      events:
        - "user_login"
        - "data_access"
        - "data_modification"
        - "data_deletion"
        - "admin_actions"
        - "crisis_intervention"
    security_monitoring:
      enabled: true
      alerts:
        - type: "failed_login"
          threshold: 5
          time_window: 300  # seconds
        - type: "data_breach"
          threshold: 1
          time_window: 60
        - type: "unusual_access"
          threshold: 10
          time_window: 3600
    
  # Incident Response
  incident_response:
    contacts:
      security_team: "security@mentalhealth.ke"
      legal_team: "legal@mentalhealth.ke"
      management: "management@mentalhealth.ke"
    procedures:
      data_breach:
        - "contain_breach"
        - "assess_impact"
        - "notify_authorities"
        - "notify_users"
        - "document_incident"
      security_incident:
        - "isolate_systems"
        - "preserve_evidence"
        - "investigate_cause"
        - "implement_fixes"
        - "update_policies"
    
  # Compliance
  compliance:
    kenya_dpa:
      enabled: true
      registration_required: true
      dpo_required: true
      breach_notification_hours: 72
    uganda_dppa:
      enabled: true
      registration_required: true
      breach_notification_hours: 72
    gdpr:
      enabled: true
      dpo_required: true
      breach_notification_hours: 72
    hipaa:
      enabled: false
      # Not directly applicable but good practices
    
  # Third-Party Security
  third_party:
    openai:
      data_processing: "anonymized_only"
      retention: "none"
      encryption: "tls_1.3"
    azure:
      data_processing: "encrypted"
      retention: "minimal"
      encryption: "aes_256"
    hume_ai:
      data_processing: "anonymized_only"
      retention: "none"
      encryption: "tls_1.3"
    
  # Development Security
  development:
    code_review:
      required: true
      security_focus: true
    dependency_scanning:
      enabled: true
      frequency: "daily"
    penetration_testing:
      frequency: "quarterly"
      scope: "full_application"
    security_training:
      required: true
      frequency: "annually"
    
  # Backup and Recovery
  backup:
    encryption: true
    frequency: "daily"
    retention: 30  # days
    location: "encrypted_cloud_storage"
    testing: "monthly"
  recovery:
    rto: 4  # hours
    rpo: 1  # hour
    procedures: "documented"
    testing: "quarterly"
    
  # Physical Security
  physical:
    data_centers:
      - location: "Nairobi, Kenya"
        security_level: "high"
        access_control: "biometric"
        monitoring: "24/7"
      - location: "Cape Town, South Africa"
        security_level: "high"
        access_control: "biometric"
        monitoring: "24/7"
    
  # Privacy by Design
  privacy_by_design:
    data_minimization: true
    purpose_limitation: true
    storage_limitation: true
    accuracy: true
    integrity: true
    confidentiality: true
    accountability: true
    
  # Risk Management
  risk_management:
    assessment_frequency: "quarterly"
    risk_tolerance: "low"
    mitigation_strategies:
      - "encryption"
      - "access_controls"
      - "monitoring"
      - "training"
      - "auditing"
    
  # Vendor Management
  vendor_management:
    due_diligence: true
    contracts: "required"
    security_assessments: "annual"
    data_processing_agreements: "required"
    breach_notification: "24_hours"
    
  # Training and Awareness
  training:
    frequency: "quarterly"
    topics:
      - "data_protection"
      - "privacy_laws"
      - "security_best_practices"
      - "incident_response"
      - "cultural_sensitivity"
    mandatory: true
    tracking: true
    
  # Audit and Compliance
  audit:
    internal:
      frequency: "quarterly"
      scope: "full_system"
    external:
      frequency: "annually"
      scope: "compliance_focus"
    remediation:
      tracking: true
      deadlines: "30_days"
      escalation: "management"
